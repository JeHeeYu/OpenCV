## 모폴로지(Morphology)란
모폴로지란 의미를 보면 형태 또는 모양에 관한 학문을 의미한다. 형태학 이라고도 한다.
<br>
영상 처리에서 모폴로지란 영상에서 객체의 형태 및 구조에 대해 분석하고 처리하는 기법을 의미한다.
<br>
수학적 모폴로지(mathematical morphology)라고도 한다.
<br>
<br>
모폴로지 기법은 그레이스케일 영상과 이진 영상에 대하여 모두 적용할 수 있다.
<br>
하지만 모폴로지는 주로 이진 영상에서 객체의 모양을 단순화시키거나 잡음을 제거하는 용도로 사용한다.

## 모폴로지 연산 방법

모폴로지 연산을 정의하려면 먼저 구조 요소(structuring element)를 정의해야 한다.
<br>
구조 요소는 필터링에서 사용되는 마스크와 같이 모폴로지 연산의 동작을 결정하는 작은 크기의 행렬이다.
<br>
<br>
구조 요소는 다양한 크기와 모양으로 정의할 수 있다.
<br>
필요에 따라 원하는 구조 요소를 선택하여 사용할 수 있지만 대부분의 모폴로지 연산에서는 3 x 3 정방향 구조 요소를 사용한다.
<br>

![image](https://user-images.githubusercontent.com/87363461/203909444-97611400-f4fd-433d-a076-74c02d231db5.png)


<br>

## 침식(erosion)과 팽창(dilation)

영상의 모폴로지 기법 중 가장 기본이 되는 연산은 침식(erosion)과 팽창(dilation)이다.
<br>
침식 연산이란 객체 영역의 외곽을 골로구 깎아 내는 연산으로, 전체적으로 객체 영역은 축소되고 배경은 확대된다.
<br>
침식 연산은 구조 요소를 영상 전체에 대해 스캔하면서, 구조 요소가 객체 영역 내부에 완전히 포함될 경우 고정점 위치 픽셀을 255로 설정한다.
<br>
<br>
팽창 연산이란 객체 외곽을 확대하는 연산으로, 팽창 연산을 수행하면 객체 영역은 확대되고, 배경 영역은 줄어든다.
<br>
팽창 연산은 구조 요소를 영상 전체에 대해 이동시키면서, 구조 요소와 객체 영역이 한 픽셀이라도 만나면 고정점 위치 픽셀을 255로 설정한다.

## 침식과 팽창 연산 수행 과정
침식과 팽창 연산 수행은 입력 영상에 구조 요소를 사용하여 수행한다.
<br>
12 x 12 크기의 입력 이진 영상을 확대하여 나타낸 것이며, 흰색으로 표시된 객체가 있다.

<br>

![image](https://user-images.githubusercontent.com/87363461/203909541-758deb32-eeee-4d77-b692-3d62220aac57.png)

<br>

모폴로지 연산은 주로 3 x 3 정방향 구조 요소를 사용한다.

<br>

![image](https://user-images.githubusercontent.com/87363461/203909574-e08bbc6c-e8b0-4774-8a6c-48e5e4116e53.png)


<br>
12 x 12 크기의 이진영상에 3 x 3 정방향 구조 요소를 이용하여 침식 연산을 수행한 결과이다.
<br>
침식 연산에 의해 객체 모양이 상하좌우 모든 방향에 대해 한 픽셀 정도 깍인 것 같이 변경된다.

<br>

![image](https://user-images.githubusercontent.com/87363461/203909621-f3bf6e04-b67b-43f4-be10-6eac63322dac.png)


<br>

위에 입력 영상에 다시 팽창 연산을 수행한 것이 아래의 결과이다.
<br>
객체 영역이 상하좌우 모든 방향에 대해 한 픽셀 정도 확대된 것처럼 변경되며, 객체 아래쪽에 작게 패인 부분이 깔끔하게 매워진다.

<br>

![image](https://user-images.githubusercontent.com/87363461/203909656-60d69ea0-b193-44fe-ac0b-843c980017e9.png)


<br>

## 침식과 팽창 연산 수행 함수

OpenCV에서 구조 요소는 원소 값이 0 또는 1로 구성된 CV_8UC1 타입의 Mat 행렬로 표현한다.
<br>
구조 요소 행렬에서 값이 1인 원소만을 이용하여 구조 요소의 모양을 결정한다.
<br>
<br>
이 구조 요소 행렬을 간단하게 생성할 수 있도록 OpenCV에서는 함수를 제공한다.

```
Mat getStructuringElement(int shape, Size ksize, Point anchor = Point(-1, -1));

shape : 구조 요소의 모양으로 MorphShapes 열거형 상수 지정
ksize : 구조 요소의 크기
anchor : 중심 좌표로 (-1, -1)을 지정하면 구조 요소의 중앙을 십자가 중심 좌표로 사용
반환값 : 구조 요소 행렬
```

getStructuringElement() 함수는 지정한 모양과 크기에 해당하는 구조 요소 행렬을 반환한다.
<br>
첫 번째 인자 shape는 구조 요소의 모양을 결정하는 역할을 하며, MorphShapes 열거형 상수를 지정할 수 있다.

